
LOCAL_MAKE_DIR := $(dir $(lastword $(MAKEFILE_LIST)))

.PHONY: wizard_training wizard/envrc.do wizard/envrc

wizard_training: $(DEBUG_MODULE)
	@echo MAKEDIR: $(LOCAL_MAKE_DIR)
	cd $(LOCAL_MAKE_DIR); $(SNORT) -v -c ftp.lua $(SNORT_DAQ_INCLUDE_OPTION) --plugin-path $(DEBUGDIR) -r pcaps/wireshark_ftp_only.pcap --warn-all
	cd $(LOCAL_MAKE_DIR); $(SNORT) -v -c snmp.lua $(SNORT_DAQ_INCLUDE_OPTION) --plugin-path $(DEBUGDIR) -r pcaps/snmp_only.pcap --warn-all
	cd $(LOCAL_MAKE_DIR); $(SNORT) -v -c ssh.lua $(SNORT_DAQ_INCLUDE_OPTION) --plugin-path $(DEBUGDIR) -r pcaps/wireshark_ssh.pcap --warn-all

define WIZARD_ENVRC_TXT
# This txt was autogenerated by running "make wizard/envrc" from the project root folder

# NOTE: This configuration will use the debug version of the plugins, and might use a debug version of snort
SNORT="$(SNORT)"
SNORT_PLUGIN_PATH="$(DEBUGDIR)"
SNORT_DAQ_INCLUDE_OPTION="$(SNORT_DAQ_INCLUDE_OPTION)"
endef

$(file >$(MAKEDIR)/wizard.envrc,$(WIZARD_ENVRC_TXT))
WIZARD_ENVRC_FILE_NAME=$(LOCAL_MAKE_DIR)/envrc

wizard/envrc: $(DEBUG_MODULE) $(LOCAL_MAKE_DIR)/makefile
	@mv $(MAKEDIR)/wizard.envrc $(LOCAL_MAKE_DIR)/$(WIZARD_ENVRC_FILE_NAME)

